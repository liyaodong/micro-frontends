<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Micro Frontends(Slides generated from Martinfowler's post)</title>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/css/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/css/theme/moon.css" id="theme"/>

<link rel="stylesheet" href="./style.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<link href="https://fonts.googleapis.com/css?family=Roboto:100,400,900" rel="stylesheet">

<section>
<section id="slide-orga428aa1">
<h2 id="orga428aa1">Micro Frontends</h2>
<img class="amp-logo" src="./banner.jpg">
<p>
<a href="https://martinfowler.com/articles/micro-frontends.html">Martin Fowler Micro Frontends</a>
</p>
</section>
</section>
<section>
<section id="slide-orgf56fac5">
<h2 id="orgf56fac5">What's the problem now</h2>
<img class="stretch" src="https://media.giphy.com/media/CaiVJuZGvR8HK/giphy.gif">
</section>
<section id="slide-orgc158765">
<h3 id="orgc158765">Monolith project</h3>
<img class="stretch" src="https://media.giphy.com/media/Dvuo12UXjxcVW/giphy.gif">
</section>
<section id="slide-org0280e31">
<h3 id="org0280e31">Monolith project</h3>
<ul>
<li>Innovation in legacy code base</li>
<li>Huge team working on same product</li>
<li>Microservice backend but a monolith frontend</li>
<li>Idea: Only refactor part of the page and do the integration</li>

</ul>
</section>
<section id="slide-orgac44541">
<h3 id="orgac44541">Value of Short Cycle</h3>
<img class="stretch" src="./tech-excellence.jpg">
<p>
<a href="https://www.thoughtworks.com/talks/thoughtworks-live-australia-2016-technical-excellence">ThoughtWorks Live - What Does Technical Excellence Look Like?</a>
</p>
</section>
<section id="slide-org2f66871">
<h3 id="org2f66871">TW Tech Radar</h3>
<ul>
<li>Nov 2016, Assess</li>
<li>Nov 2017, Trial</li>
<li>Apr 2019, Adopt</li>

</ul>
</section>
<section id="slide-org792a7bc">
<h3 id="org792a7bc">Definition</h3>
<blockquote nil>
<p>
"An architectural style where independently deliverable frontend applications are composed into a greater whole"
</p>
</blockquote>
</section>
</section>
<section>
<section id="slide-org656e5ea">
<h2 id="org656e5ea">Demo Time</h2>
<img class="stretch" src="https://martinfowler.com/articles/micro-frontends/demo-architecture.png">
<p>
<a href="https://demo.microfrontends.com/">https://demo.microfrontends.com/</a>
</p>
</section>
</section>
<section>
<section id="slide-org48d614a">
<h2 id="org48d614a">Industry</h2>
<ul>
<li>Google Could: SPA, AngularJS + Angular2</li>
<li>AWS: MPA, Angular + separate domain for sub app</li>
<li>Qiniu: SPA + MPA</li>
<li>Alicloud: SPA by Qiankun micro frontend framework</li>

</ul>

<p>
<a href="https://developer.aliyun.com/article/742576">source</a>
</p>
</section>
</section>
<section>
<section id="slide-orgabb5123">
<h2 id="orgabb5123">Pros of micro frontends</h2>
<ul>
<li>Smaller, more cohesive and maintainable codebases</li>
<li>More scalable organisations with decoupled, autonomous teams</li>
<li>The ability to upgrade, update, or even rewrite parts of the frontend in a more incremental fashion than was previously possible</li>

</ul>
</section>
<section id="slide-orgbba226c">
<h3 id="orgbba226c">Incremental upgrades</h3>
<ul>
<li>Instead of rewrite the whole application</li>
<li>Refactor piece by piece</li>

</ul>
</section>
<section id="slide-org9bb15ef">
<h3 id="org9bb15ef">Simple, decoupled codebases</h3>
<ul>
<li>Smaller code base is easy to work with</li>
<li>Force to decouple the logic between parts application</li>
<li>Sharing domain models across bounded contexts becomes more difficult</li>

</ul>
</section>
<section id="slide-org5b492b7">
<h3 id="org5b492b7">Independent deployment</h3>
<img class="stretch" src="https://martinfowler.com/articles/micro-frontends/deployment.png">
</section>
<section id="slide-orga97b47f">
<h3 id="orga97b47f">Independent deployment</h3>
<ul>
<li>Each micro frontend should have its own continuous delivery pipeline</li>
<li>It shouldn't matter if the old monolith is on a fixed, manual, quarterly release cycle</li>
<li>Independent release cycles</li>

</ul>
</section>
<section id="slide-org7551c05">
<h3 id="org7551c05">Autonomous teams</h3>
<ul>
<li>Teams can have full ownership of everything they need</li>
<li>Move quickly and effectively</li>

</ul>
</section>
<section id="slide-org0f31bd0">
<h3 id="org0f31bd0">Autonomous teams</h3>
<img class="stretch" src="https://martinfowler.com/articles/micro-frontends/horizontal.png">
</section>
<section id="slide-orge515360">
<h3 id="orge515360">In a nutshell</h3>
<ul>
<li>Slicing up big and scary things into smaller, more manageable pieces</li>
<li>Explicit about the dependencies</li>
<li>Release and manage the process people without excessive coordination</li>

</ul>
</section>
</section>
<section>
<section id="slide-org7d6b368">
<h2 id="org7d6b368">Requirement Example</h2>
<img class="stretch" src="https://martinfowler.com/articles/micro-frontends/wireframe.png">
</section>
<section id="slide-org90c0c1b">
<h3 id="org90c0c1b">Container application</h3>
<img class="stretch" src="https://martinfowler.com/articles/micro-frontends/composition.png">
</section>
<section id="slide-org72e3fce">
<h3 id="org72e3fce">Container application</h3>
<ul>
<li>Register and render frontends apps</li>
<li>Manage routing/authentication</li>
<li>Manage other micro frontends</li>
<li>Logging/Analytics/API</li>
<li>Dependency management</li>

</ul>
</section>
</section>
<section>
<section id="slide-org3f69eca">
<h2 id="org3f69eca">Different Patterns</h2>
<div class="outline-text-2" id="text-org3f69eca">
</div>
</section>
<section id="slide-org4727d91">
<h3 id="org4727d91">Server-side template composition</h3>
<img class="stretch" src="https://martinfowler.com/articles/micro-frontends/ssi.png">
</section>
<section id="slide-orgcf2ee49">
<h3 id="orgcf2ee49">Server-side template composition</h3>
<div class="org-src-container">

<pre  class="src src-html"><code trim>&lt;<span style="color: #A6E22E;">body</span>&gt;
  &lt;<span style="color: #A6E22E;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Feed me</span>&lt;/<span style="color: #A6E22E;">h1</span>&gt;
  <span style="color: #8C8C8C;">&lt;!--</span><span style="color: #8C8C8C;"># include file="$PAGE.html" </span><span style="color: #8C8C8C;">--&gt;</span>
&lt;/<span style="color: #A6E22E;">body</span>&gt;
</code></pre>
</div>
<div class="org-src-container">

<pre  class="src src-conf"><code trim><span style="color: #66D9EF;">server</span> {
    listen 8080;
    ...

    <span style="color: #66D9EF;">location /browse</span> {
      set $PAGE <span style="color: #EEDC82;">'browse'</span>;
    }
    <span style="color: #66D9EF;">location /order</span> {
      set $PAGE <span style="color: #EEDC82;">'order'</span>;
    }
}
</code></pre>
</div>
</section>
<section id="slide-org8104f49">
<h3 id="org8104f49">Build-time integration</h3>
<div class="org-src-container">

<pre  class="src src-json"><code trim><span style="color: #8c8c8c;">{</span>
  <span style="color: #F92672;">"name"</span>: <span style="color: #EEDC82;">"@feed-me/container"</span>,
  <span style="color: #F92672;">"version"</span>: "<span style="color: #FF80F4;">1</span>.<span style="color: #FF80F4;">0</span>.<span style="color: #FF80F4;">0</span>",
  <span style="color: #F92672;">"description"</span>: <span style="color: #EEDC82;">"A food delivery web app"</span>,
  <span style="color: #F92672;">"dependencies"</span>: <span style="color: #93a8c6;">{</span>
    <span style="color: #F92672;">"@feed-me/browse-restaurants"</span>: "^<span style="color: #FF80F4;">1</span>.<span style="color: #FF80F4;">2</span>.<span style="color: #FF80F4;">3</span>",
    <span style="color: #F92672;">"@feed-me/order-food"</span>: "^<span style="color: #FF80F4;">4</span>.<span style="color: #FF80F4;">5</span>.<span style="color: #FF80F4;">6</span>",
    <span style="color: #F92672;">"@feed-me/user-profile"</span>: "^<span style="color: #FF80F4;">7</span>.<span style="color: #FF80F4;">8</span>.<span style="color: #FF80F4;">9</span>"
  <span style="color: #93a8c6;">}</span>
<span style="color: #8c8c8c;">}</span>
</code></pre>
</div>
<ul>
<li>Release together 😅</li>

</ul>
</section>
<section id="slide-org9f959a2">
<h3 id="org9f959a2">Run-time integration via iframes</h3>
<div class="org-src-container">

<pre  class="src src-html"><code trim>&lt;<span style="color: #A6E22E;">body</span>&gt;
  &lt;<span style="color: #A6E22E;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Welcome to Feed me!</span>&lt;/<span style="color: #A6E22E;">h1</span>&gt;
  &lt;<span style="color: #A6E22E;">iframe</span> <span style="color: #FD971F;">id</span>=<span style="color: #EEDC82;">"micro-frontend-container"</span>&gt;&lt;/<span style="color: #A6E22E;">iframe</span>&gt;
  &lt;<span style="color: #A6E22E;">script</span> <span style="color: #FD971F;">type</span>=<span style="color: #EEDC82;">"text/javascript"</span>&gt;
    const microFrontendsByRoute = {
    '/': 'https://browse.example.com/index.html',
    '/order-food': 'https://order.example.com/index.html',
    '/user-profile': 'https://profile.example.com/index.html',
    };

    const iframe = document.getElementById('micro-frontend-container');
    iframe.src = microFrontendsByRoute[window.location.pathname];
  &lt;/<span style="color: #A6E22E;">script</span>&gt;
&lt;/<span style="color: #A6E22E;">body</span>&gt;
</code></pre>
</div>
</section>
<section id="slide-org7b7b849">
<h3 id="org7b7b849">Run-time integration via iframes</h3>
<ul>
<li>Difficult to build integrations between different parts</li>
<li>Routing, history, and deep-linking more complicated</li>

</ul>
</section>
<section id="slide-org218d69c">
<h3 id="org218d69c">Run-time integration via JavaScript</h3>
<div class="org-src-container">

<pre  class="src src-html"><code trim>&lt;<span style="color: #A6E22E;">body</span>&gt;
  &lt;<span style="color: #A6E22E;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Welcome to Feed me!</span>&lt;/<span style="color: #A6E22E;">h1</span>&gt;
  <span style="color: #8C8C8C;">&lt;!-- </span><span style="color: #8C8C8C;">These scripts don't render anything immediately </span><span style="color: #8C8C8C;">--&gt;</span>
  <span style="color: #8C8C8C;">&lt;!-- </span><span style="color: #8C8C8C;">Instead they attach entry-point functions to `window` </span><span style="color: #8C8C8C;">--&gt;</span>
  &lt;<span style="color: #A6E22E;">script</span> <span style="color: #FD971F;">src</span>=<span style="color: #EEDC82;">"https://browse.example.com/bundle.js"</span>&gt;&lt;/<span style="color: #A6E22E;">script</span>&gt;
  &lt;<span style="color: #A6E22E;">script</span> <span style="color: #FD971F;">src</span>=<span style="color: #EEDC82;">"https://order.example.com/bundle.js"</span>&gt;&lt;/<span style="color: #A6E22E;">script</span>&gt;
  &lt;<span style="color: #A6E22E;">script</span> <span style="color: #FD971F;">src</span>=<span style="color: #EEDC82;">"https://profile.example.com/bundle.js"</span>&gt;&lt;/<span style="color: #A6E22E;">script</span>&gt;
  &lt;<span style="color: #A6E22E;">div</span> <span style="color: #FD971F;">id</span>=<span style="color: #EEDC82;">"micro-frontend-root"</span>&gt;&lt;/<span style="color: #A6E22E;">div</span>&gt;
  &lt;<span style="color: #A6E22E;">script</span> <span style="color: #FD971F;">type</span>=<span style="color: #EEDC82;">"text/javascript"</span>&gt;
    // These global functions are attached to window by the above scripts
    const microFrontendsByRoute = {
      '/': window.renderBrowseRestaurants,
      '/order-food': window.renderOrderFood,
      '/user-profile': window.renderUserProfile,
    };
    const renderFunction = microFrontendsByRoute[window.location.pathname];

    // Having determined the entry-point function, we now call it,
    // giving it the ID of the element where it should render itself
    renderFunction('micro-frontend-root');
  &lt;/<span style="color: #A6E22E;">script</span>&gt;
&lt;/<span style="color: #A6E22E;">body</span>&gt;
</code></pre>
</div>
</section>
<section id="slide-org9caea49">
<h3 id="org9caea49">Run-time integration via JavaScript</h3>
<ul>
<li>flexibility of integration</li>
<li>can be lazyloaded</li>
<li>default choice</li>

</ul>
</section>
<section id="slide-org466701f">
<h3 id="org466701f">Run-time integration via Web Components</h3>
<div class="org-src-container">

<pre  class="src src-html"><code trim>&lt;<span style="color: #A6E22E;">body</span>&gt;
  &lt;<span style="color: #A6E22E;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Welcome to Feed me!</span>&lt;/<span style="color: #A6E22E;">h1</span>&gt;
  <span style="color: #8C8C8C;">&lt;!-- </span><span style="color: #8C8C8C;">These scripts don't render anything immediately </span><span style="color: #8C8C8C;">--&gt;</span>
  <span style="color: #8C8C8C;">&lt;!-- </span><span style="color: #8C8C8C;">Instead they each define a custom element type </span><span style="color: #8C8C8C;">--&gt;</span>
  &lt;<span style="color: #A6E22E;">script</span> <span style="color: #FD971F;">src</span>=<span style="color: #EEDC82;">"https://browse.example.com/bundle.js"</span>&gt;&lt;/<span style="color: #A6E22E;">script</span>&gt;
  &lt;<span style="color: #A6E22E;">script</span> <span style="color: #FD971F;">src</span>=<span style="color: #EEDC82;">"https://order.example.com/bundle.js"</span>&gt;&lt;/<span style="color: #A6E22E;">script</span>&gt;
  &lt;<span style="color: #A6E22E;">script</span> <span style="color: #FD971F;">src</span>=<span style="color: #EEDC82;">"https://profile.example.com/bundle.js"</span>&gt;&lt;/<span style="color: #A6E22E;">script</span>&gt;
  &lt;<span style="color: #A6E22E;">div</span> <span style="color: #FD971F;">id</span>=<span style="color: #EEDC82;">"micro-frontend-root"</span>&gt;&lt;/<span style="color: #A6E22E;">div</span>&gt;
  &lt;<span style="color: #A6E22E;">script</span> <span style="color: #FD971F;">type</span>=<span style="color: #EEDC82;">"text/javascript"</span>&gt;
    // These element types are defined by the above scripts
    const webComponentsByRoute = {
      '/': 'micro-frontend-browse-restaurants',
      '/order-food': 'micro-frontend-order-food',
      '/user-profile': 'micro-frontend-user-profile',
    };
    const webComponentType = webComponentsByRoute[window.location.pathname];

    // Having determined the right web component custom element type,
    // we now create an instance of it and attach it to the document
    const root = document.getElementById('micro-frontend-root');
    const webComponent = document.createElement(webComponentType);
    root.appendChild(webComponent);
  &lt;/<span style="color: #A6E22E;">script</span>&gt;
&lt;/<span style="color: #A6E22E;">body</span>&gt;
</code></pre>
</div>
</section>
<section id="slide-org4855b62">
<h3 id="org4855b62">Run-time integration via Web Components</h3>
<ul>
<li>The web component way</li>
<li>Browser compatibility(IE??)</li>

</ul>
</section>
</section>
<section>
<section id="slide-orga609f67">
<h2 id="orga609f67">CSS pollution</h2>
<ul>
<li>global, inheriting, and cascading</li>
<li>no module system, namespacing or encapsulation</li>

</ul>
</section>
<section id="slide-org1fce7bb">
<h3 id="org1fce7bb">How to avoid</h3>
<ul>
<li>BEM</li>
<li>SASS with nested namespace</li>
<li>CSS Modules</li>
<li>Shadow DOM</li>
<li>CSS in JS</li>

</ul>
</section>
</section>
<section>
<section id="slide-org9e88fa5">
<h2 id="org9e88fa5">JS pollution</h2>
<ul>
<li>iframe</li>
<li>"JS Sandbox"</li>
<li>snapshot for global variable before mount</li>
<li>restore snapshot after subapp unmount</li>

</ul>
</section>
</section>
<section>
<section id="slide-org6ee0ebe">
<h2 id="org6ee0ebe">Shared component libraries</h2>
<ul>
<li>Visual consistency across micro frontends</li>
<li>A living styleguide between developers and designers</li>
<li>Difficult to do well</li>

</ul>
</section>
<section id="slide-orgf4f0199">
<h3 id="orgf4f0199">Non-stable components API</h3>
<ul>
<li>Framework like components</li>
<li>Define the API before real-world usage</li>
<li>Teams create their own components first</li>
<li>Extract duplicate code into a shared library</li>

</ul>
</section>
<section id="slide-org18479b8">
<h3 id="org18479b8">Logic in shared component library</h3>
<ul>
<li>Dumb UI component</li>
<li>UI logic like dropdown/auto complete</li>
<li>Business logic like product table?</li>

</ul>
</section>
<section id="slide-org4aa1de9">
<h3 id="org4aa1de9">Ownership and governance</h3>
<ul>
<li>Who own the library? everyone? no one?</li>
<li>Centralised development team?</li>
<li>Anyone can contribute to the library, but have a admin person</li>
<li>Ensuring the quality, consistency, and validity</li>

</ul>
</section>
</section>
<section>
<section id="slide-orgff2d946">
<h2 id="orgff2d946">Cross-application communication</h2>
<p>
Avoid too many communicate
</p>
</section>
<section id="slide-orgfba7fdf">
<h3 id="orgfba7fdf">How</h3>
<ul>
<li>Custom events</li>
<li>Container component as a birdge(Just like react/redux)</li>
<li>Address bar</li>

</ul>
</section>
<section id="slide-orge4ba6c3">
<h3 id="orge4ba6c3">Avoid share state</h3>
<ul>
<li>Just like sharing a database across microservices</li>
<li>Create massive amounts of coupling</li>

</ul>
</section>
<section id="slide-org29e2bcf">
<h3 id="org29e2bcf">Some Other Thoughts</h3>
<img class="stretch" src="./share-nothing.png">
</section>
</section>
<section>
<section id="slide-org705e3ea">
<h2 id="org705e3ea">Backend communication</h2>
<img class="stretch" src="https://martinfowler.com/articles/micro-frontends/bff.png">
</section>
<section id="slide-orgc7f8db9">
<h3 id="orgc7f8db9">Authentication</h3>
<ul>
<li>Own by container component</li>
<li>Manage login status by container component</li>
<li>Inject token to each micro frontends</li>

</ul>
</section>
</section>
<section>
<section id="slide-org09570c2">
<h2 id="org09570c2">Free Lunch?</h2>
<blockquote nil>
<p>
There are no free lunches when it comes to software architecture - everything comes with a cost.
</p>
</blockquote>
</section>
<section id="slide-org8c909d2">
<h3 id="org8c909d2">Payload Size</h3>
<ul>
<li>What's the library we need to share</li>
<li>Share more library or less library</li>
<li>Download JS ahead vs lazyload by each micro frontends</li>

</ul>
</section>
<section id="slide-org2b8e1e1">
<h3 id="org2b8e1e1">Different micro frontends integration with container</h3>
<ul>
<li>Spend time on integration or spend time on "standalone" mode to develop</li>
<li>Debugging across different application</li>

</ul>
</section>
<section id="slide-org6e8eec8">
<h3 id="org6e8eec8">Operational and governance complexity</h3>
<ul>
<li>Enough automation for infrastructure?</li>
<li>Will your project have many micro frontends?</li>
<li>Tooling and development practices will be decentralised?</li>
<li>Quality, consistency, or governance across your many independent frontend codebases?</li>

</ul>
</section>
</section>
<section>
<section id="slide-orgbc9125e">
<h2 id="orgbc9125e">Conclusion</h2>
<blockquote nil>
<p>
We need to be able to draw clear boundaries that establish the right levels of coupling and cohesion between technical and domain entities.
</p>

<p>
We should be able to scale software delivery across independent, autonomous teams.
</p>
</blockquote>
</section>
</section>
<section>
<section id="slide-orge97bc2a">
<h2 id="orge97bc2a">Q&amp;A</h2>
</section>
</section>
<section>
<section id="slide-org8ca504b">
<h2 id="org8ca504b">Further reading</h2>
<ul>
<li><a href="https://martinfowler.com/articles/micro-frontends.html">Martin Fowler Micro Frontends</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/78362028">可能是你见过的最完善的微前端方案</a></li>
<li><a href="https://developer.aliyun.com/article/742576">标准微前端架构在蚂蚁的落地实践</a></li>
<li><a href="https://microfrontends.cn/">微前端的那些事儿</a></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgd7963e9">
<h2 id="orgd7963e9">Thanks</h2>
<img class="stretch" src="https://media.giphy.com/media/t8dgAcwIMa5dZzNhqU/giphy.gif">
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
history: true,
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/lib/js/classList.js', condition: function() { return !document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]
});
</script>
</body>
</html>
